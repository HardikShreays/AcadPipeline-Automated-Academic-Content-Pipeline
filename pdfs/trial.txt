
## Introduction


## 22


## MongoDB


## Querying &


## Aggregation


## Join the Lecture on NS Portal :)


## Dataset Overview


## Collection Name: students


## Each document includes:


## ● name, age, major


## ● subjects (array)


## ● scores (array of embedded documents)


## ● Optional graduation_Date


## Ideal for demonstrating:


## ● Array queries


## ● Embedded document queries


## ● Aggregation analytics Dataset


## Querying Related Documents


## MongoDB allows querying:
Simple fields ● Array values ● Embedded documents ● Nested conditions ● Existence of fields ●

## Designed to retrieve related information without joins.


## Querying Simple Fields


## Example: Students majoring in Computer Science
db.students.find({ major: "Computer Science" })

## Fetches all documents where major matches exactly.


## Querying Array Fields


## Example: Students studying “Math”
db.students.find({ subjects: "Math" })

## Matches array elements automatically.


## Simple Field Query vs Array Field Query


## Short Summary Difference
Feature Simple Field Query Array Field Query Data type Single value Multiple values (array) Example field major: "CS" subjects: ["Math", "AI"] Query { major: "CS" } { subjects: "Math" } Matching Exact equality Matches any element inside array Behavior Straight comparison MongoDB searches inside arra...

## Querying Embedded Documents


## Example: Students scoring 95 in Math
db.students.find({ scores: { $elemMatch: { subject: "Math", score: 95 } } }) $elemMatch ensures both conditions match the same embedded document.

## Comparison & Logical Queries


## Comparison:
db.students.find({ age: { $gt: 22 } })

## Logical:
db.students.find({ $or: [ { major: "Computer Science" }, { major: "Information Technology" } ] })

## Aggregation Overview


## Aggregation performs:
Summaries ● Analytics ● Grouping ● Calculations ● Data transformation ●

## Uses multiple stages in a pipeline.


## Key Aggregation Operators


## ● $match – Filter ● $group – Aggregate ● $project – Select/reshape fields ● – Sorting $sort ● – Flatten arrays $unwind ● – Counts $count ● $avg , $sum , $min , $max – Computations


## Counting Documents


## Find total number of documents in students collection.
db.studentdetails.aggregate([ { $count: "Total Students" } ])

## Result: Number of documents in students collection.


## Grouping by Major Find how many students are there in each Department
db.studentdetails.aggregate( [ { $group: { _id: "$department", total: { $sum: 1 } } } ] )

## This pipeline groups students by their Department and uses $sum: 1


## to count how many students belong to each Department.


## We can also use $count:{} to count all students in each department.


## Average Score in each subject


## Find the average score for in each subject
db.studentdetails.aggregate([ { $unwind: "$subjects" }, { $group: { _id: "$subjects.name", avgMarks: { $avg: "$subjects.marks" } } } ])

## Average Score in DBMS


## Find the average score for all students in DBMS subject and round it off to two decimal places.
db.studentdetails.aggregate([ { $unwind: "$subjects" }, { $match: { "subjects.name": "DBMS" } }, { $group: { _id: "DBMS", avgScore: { $avg: "$subjects.marks" } } }, {$project:{_id:1,avgScore:{$round:["$avgScore",2]}}} ])

## This pipeline calculates the average “DBMS” score by unwinding(separating) all scores, filtering only DBMS entries, and then grouping them to compute the average using $avg & further rounding off using $round operator in $project.


## Highest Scorer in DBMS
db.studentdetails.aggregate([ { $unwind: "$subjects" }, { $match: { "subjects.name": "DBMS" } }, { $sort: { "subjects.marks": -1 } }, { $limit: 1 } ])

## This pipeline finds the highest DBMS score by unwinding all subjects, filtering only DBMS scores, sorting them from highest to lowest, and returning just the top result.


## Aggregation Pipeline
A MongoDB aggregation pipeline processes data step-by-step, where each stage performs a specific transformation and then passes the modified documents to the next stage. Together, these stages form a pipeline that transforms raw data into meaningful analytical output. Pipeline = series of stages ● S...

## Total Score per Student
db.studentdetails.aggregate([ { $unwind: "$subjects" }, { $group: { _id: "$name", totalScore: { $sum: "$subjects.marks" } }}, { $sort: { totalScore: -1 } } ])

## This pipeline expands each student’s scores with $unwind , then $group sums all the score values to compute each student’s totalScore , and finally $sort arranges them in descending order so the highest-scoring students appear first.


## Average Score per Student
db.studentdetails.aggregate([ { $unwind: "$subjects" }, { $group: { _id: { name: "$name" }, avgScore: { $avg: "$subjects.marks" } }}, { $sort: { avgScore: -1 } } ])

## This pipeline uses $unwind to split each student’s scores into separate documents, then $group (by name) to calculate each student’s average score with $avg , and finally $sort orders them in descending order to show the highest-performing students first.


## Highest Score per Student
db.studentdetails.aggregate([ { $unwind: "$subjects" }, { $group: { _id: "$name", maxScore: { $max: "$subjects.marks" } }}, { $sort: { maxScore: -1 } } ])

## This pipeline uses $unwind to split each student’s scores into individual entries, then $group (by name) to find each student’s highest score using $max , and finally $sort arranges the students in descending order of their maxScore to show who achieved the highest single score.
$group Counts how many students belong to each Count students per major major . db.studentdetails.aggregate([ How it works: { $group: { ● $group groups all documents based on _id: "$major", the value of major . totalStudents: { $sum: 1 } ● _id: "$major" → Each unique major } becomes one group. } ● $...

## Result:
You get a list of majors with the number of students in each major.

## $group — When to Use


## To group documents and perform aggregations like:


## ● sum ● count ● max ● min ● average


## Use $group when:


## ● You want summary/aggregation results. ● You need student-wise, subject-wise, major-wise reports. ● You want counts, totals, highest score, lowest score etc.


## $lookup — When to Use
Purpose: Assume you have another collection: To join data from another collection into the db.departments.insertMany([ current pipeline. { major: "Computer Science", hod: "Dr. Sharma" }, Use $lookup when: { major: "Physics", hod: "Dr. Rao" }, { major: "Math", hod: "Dr. Bose" } ● You have related dat...

## $lookup — Example Performs a LEFT JOIN between students and Assume you have another collection: departments based on the major field.
db.studentdetails.aggregate([ How it works: { ● localField: "major" → Read the student’s major $lookup: { ● foreignField: "major" → Match it with the from: "courses", department’s major localField: "course_ids", ● from: "departments" → Join with this collection foreignField: "_id", ● as: "major_deta...

## $lookup —
Q. Count how many students are enrolled in each course.Display course name & count of students db.studentdetails.aggregate([ { $lookup: { from: "courses", localField: "course_ids", foreignField: "_id", as: "courseDetails" } }, { $unwind: "$courseDetails" }, { $group: { _id: "$courseDetails.name", to...

## $sort — When to Use
Sort students by age (descending) Purpose: db. studentdetails .find().sort({ age: -1 }); To sort documents in ascending or descending order. Sort students by highest score Use $sort when: studentdetails db. .aggregate([ { $unwind: "$subjects" }, ● You want top scorers , youngest { students , latest ...

## Summary - When to use
Operator Use When Example Case (Your Dataset) $lookup Need to join 2 collections Join students with departments $group Need aggregation/summaries Find highest marks / student count $sort Need ordering Top scorers, youngest students

## Summary


## ● MongoDB queries allow searching arrays, embedded docs, and conditions. ● Aggregation provides deep analytics using $group , $unwind , $project . ● Aggregation pipeline enables multi step data processing. ● Dataset helps demonstrate score analysis and graduation insights. ● $group → Groups documents by a field and performs operations like count, sum, avg, max. ● $sort → Arranges documents in ascending (1) or descending (-1) order. ● $lookup → Joins data from another collection based on matching fields.


## Thank You !!


## See You Guys in Next


## Session :)
